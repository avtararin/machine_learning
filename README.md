# machine_learning
 Этот репозиторий предназначен для работ по машинному обучению
Лабараторная работа №1 
Тарарин Александр ПМИ 3-1
Вариант №18
Тема: Оценка точности модели с непрерывной зависимой переменной. В примерах ниже показано: как делить данные на выборки(обучающую и тестовую), как считать MSE; среднеквадратичную ошибку модели; как меняются MSE на тестовой и обучающей выборках с изменением гибкости модели. 
Задача 1.
На данных своего варианта (см. второй столбец таблицы с вариантами) повторить расчёты
и построить графики из первой лабораторной. Пояснить выбор наилучшего количества степеней
свободы.
Решение:
1. Задаем исходные данные и функцию. Пострим по ним обуч. и тестир. выборки. Представим данные на графике
2. Построим при помощи библиотеки R сплайны на обучающей выборке для df=38. Проверим MSE значение для обучающей и тестир. выборок. Получим сплайн на графике
3. попробуем разные значения df[2;40] и найдем такое при котором MSE будет минимальным. Представим на графике значения MSE для разных значений df
Результаты:
При переборе разных значений df мы определили, что для функции f(x)=15 + 0.02*x-0.005*((x-45)**2) + 0.00006 лучшее значение df=6, тк на графике наименьшее значение MSE равно 6
Задача 2.
Повторить расчёты, меняя характеристики согласно своему варианту (см. последний
столбец таблицы с вариантами). Проанализировать, как меняется MSE при изменении характеристик.
Решение:
Повторим перебор df значений [2; 40] из Задачи 1 для разных значений sigma [6, 7, 8]. Полученные значения сохраним в фрейм, и выберем для каждого sigma такое df, чтобы тестовое MSE было наименьшим. Представим графики обучающих и тестовых MSE для разных df и для разных sigma, выделяя точки с наименьшим тестовым MSE 
Результат:
При увеличение sigma увеличивается MSE_traiт, MSE_test
при sigma 6 MSE_train 59.782252,MSE_test 99.229981
при sigma 7 MSE_train 46.023362	MSE_test 77.999113
при sigma 8 MSE_train 59.782252	MSE_test 99.229981

Методы и технологии машинного обучения.

Репозиторий для лабораторных работ по дисциплине "Методы и технологии машинного обучения".
Вариант 18.
# Лабораторная работа №2. Линейные модели. Кросс-валидация.

В практических примерах ниже показано:

как пользоваться инструментами предварительного анализа для поиска линейных
взаимосвязей;

как строить и интерпретировать линейные модели с логарифмами;

как оценивать точность моделей с перекрёстной проверкой (LOOCV, проверка по блокам).

Модели: множественная линейная регрессия

Данные: https://raw.githubusercontent.com/ania607/ML/main/data/College_for_lab.csv

Проверка методом K-FOLD, K-VAL = 5;

Зависимая переменная - Grad_rate / выпускной
балл

Независимые переменные:


*   Expend /расходы наобучение на одного студента
*   Top25perc /процент зачисленных студентов которые в старшей школе относились к топ-25% в диапазоне по освоению
*   Private частный или государственный университет: Да - частный, Нет - государственный

Задания:
1. Данные своего варианта (см. таблицу ниже) разделить на выборку для построения
моделей (80%) и отложенные наблюдения (20%). Оставить в таблице только указанные в
варианте переменные. Отложенные наблюдения использовать только в задании 6.
2. Провести предварительный анализ данных с помощью описательных статистик и
графиков, оценить взаимосвязь.
3. Проверить Y на нормальность. Если он распределён не по нормальному закону,
прологарифмировать и снова провести анализ взаимосвязей переменных.
4. Составить список возможных спецификаций моделей множественной регрессии (на
исходной Y и на логарифме Y ).
5. Оценить параметры моделей из списка. Оценить точность моделей методом
перекрёстной проверки, указанным в варианте. Найти самую точную из моделей для Y .
Найти самую точную из моделей для log(Y ).
6. Сделать прогноз с помощью самых точных моделей на отложенные наблюдения.
Рассчитать MSEtest вручную и выбрать одну наиболее точную модель. Проинтерпретировать её параметры.


Задание 1. Решение.

Загрузим все необходимые для работы модули, определим константы и загрузим входные данные. Во входных данных отфильтруем только необходимые нам для работы признаки.

Определим фиктивные переменные для качественного признака и объединим их с исходными данными.

Разделим исходную выборку на тренировочную и тестовую.


Задание 1. Результаты.

Мы получили две выборки: тренировочную и тестовую, содержащие необходимые для работы данные.


Задание 2. Решение.

Проведем предварительный анализ данных на тренировочной выборке:

*   Построим гистограммы распределения и графики зависимости количественных переменных;
*   Построим гистограммы распределения и графики зависимости количественных переменных для разных значений качественной переменной;
*   Построим матрицу корреляции количественных переменных;
*   Построим матрицу корреляции количественных переменных для разных значений качественной переменной.


Задание 2. Результаты.

По гистограмме распределения "Grad_Rate" можно сделать предположение, что данные распределены нормально.

По графикам распределения видно, что переменная "Grad_Rate" слабо зависит от "Top25perc", "Expend".

Разные значения качественной переменной "Private" показывают, что распределение выпускного балла у студентов, которые выпустились из частной школы шире, значит диапозон из оценок больше, как в большую, так и в меньшую стороны.


Задание 3. Решение.

Проверим распределение переменной "Grad_Rate" на нормальность при помощи теста Шапиро-Уилка. Если распределение не является нормальным, проверим логарифм переменной на нормальность.


Задание 3. Результаты.

Мы определили, что распределение переменной "Grad_Rate" является нормальным.

Так как  мы уже подтвердили нормальность переменной "Grad_Rate", логарифм переменной "Grad_Rate" далее рассматриваться не будет.


Задание 4. Решение. Результаты.

В соответствии с результатами задания 2 можно составить следующие линейные спецификации модели:

1.   Grad_Rate = Expend +Top25perc + Private
2.   Grad_Rate = Expend * Private + Top25perc + Private
3.   Grad_Rate = Expend + Top25perc * Private + Private
4.   Grad_Rate = Expend + Top25perc * Private + Expend * Private + Private

В соответствии с результатами задания 3, показательные модели рассматриваться не будут.


Задание 5. Решение.

Построим модели, определенные в задании 4.

Определим параметры моделей и оценим их точность методом K-FOLDS (K-VAl = 5).

Найдем самую точную из моделей.


Задание 5. Результаты.

Мы определили, что наименьшую ошибку методом K-FOLDS (K-VAL = 5) выдает модель №3:

Grad_Rate = Expend + Top25perc * Private + Private


Задание 6. Решение.

Сделаем прогноз третей моделью на тестовые данные и оценим полученную ошибку тестирования. Оценим среднюю ошибку модели.

Построим третью модель на всех данных и проинтерпретируем ее параметры.


Задание 6. Результаты.

Средняя ошибка  модели (построенной на тренировочных данных) равна 22.7% от среднего значения "Grad_Rate".

В результате построения на всех данных была получена модель:

Grad_Rate = -2.13 * Private +  0.3 * Top25perc  + 0.0009 * Expend * Private

Ее параметры можно интерпретировать следующим образом:


1.   При увеличении процента выпускаемых учеников, входящих в топ 25, средняя оценка увеличивается на 0.3
2.   В зависимости из какой школы выпускался ученик его средняя оценка тоже измняется - если учник из частной школы в среднем его бал ниже на 2.13
3. Траты на ученика из частной школы дают при изменении трат на 1 доллар прирост в 0.0009 от средней оцнеки